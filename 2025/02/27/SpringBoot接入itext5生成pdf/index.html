<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>SpringBoot接入itext5生成pdf</title><meta name="description" content="666"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- 解决403图片防盗链的问题 -->    <meta content="no-referrer" name="referrer"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><link rel="stylesheet" href="/style/custom.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.5.2/css/all.css"><!--link(rel='stylesheet', href= url_for('/style/themes/monokai-sublime.min.css'))--><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><!--script(src= url_for("/js/highlight.pack.js"))--><script src="/js/highlight.min.js"></script><style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style><script src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"> </script><script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script><script src="/js/hightlight/codeBLang.js"> </script><script src="/js/hightlight/codeBlockFuction.js"> </script><script src="/js/hightlight/codeCopy.js"> </script><script src="/js/hightlight/fullScreen.js"> </script><script src="/js/hightlight/codeShrink.js"> </script><meta name="description" content="SpringBoot集成itext5，实现pdf生成1、前言在项目开发中有需要生成pdf文件的功能，常见的方案如下：

html作为模板，（Thymeleaf、freemaker等模板引擎）渲染数据，最后生成pdf
使用pdf模板（使用如：Adobe Acrobat编辑器，创建一个带有表单字段的PDF），填充数据，最后生成pdf
使用pdf模板（使用占位符，比如${name}），用数据替换占位符，最后生成pdf。比较复杂，不容易实现，不建议。

如何得到pdf文件，主要有两种方法，一种是写代码生成，还有就是用pdf转换工具，比如wkhtmltopdf之类的。由于在项目中考虑到，使用html的方案，在修改模板时对用户不友好，所以采用了方案2：pdf模板+表单+填充数据。
工具使用itext5，因为itext7.."><meta name="generator" content="Hexo 7.0.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="ZQG的博客" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">ZQG's blog  </a><iframe frameborder="0" height="20" hspace="0" scrolling="no" src="https://i.tianqi.com/?c=code&amp;a=getcode&amp;id=1&amp;icon=1" width="550"></iframe><iframe clocktype="html5" frameborder="no" scrolling="no" style="overflow:hidden;border:0;margin:0;padding:0;width:140px;height:25px;" src="https://www.clocklink.com/html5embed.php?clock=047&amp;timezone=CCT&amp;color=black&amp;size=140&amp;Title=&amp;Message=&amp;Target=&amp;From=2024,1,1,0,0,0&amp;Color=black"></iframe></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">SpringBoot接入itext5生成pdf</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot%E9%9B%86%E6%88%90itext5%EF%BC%8C%E5%AE%9E%E7%8E%B0pdf%E7%94%9F%E6%88%90"><span class="toc-text">SpringBoot集成itext5，实现pdf生成</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-text">1、前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B"><span class="toc-text">2、开发过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E7%9B%B8%E5%85%B3%E4%BE%9D%E8%B5%96"><span class="toc-text">引入相关依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%A5%BDpdf%EF%BC%8C%E5%B9%B6%E4%B8%94%E8%AE%BE%E7%BD%AE%E5%A5%BD%E8%A1%A8%E5%8D%95%E5%AD%97%E6%AE%B5%E3%80%82"><span class="toc-text">准备好pdf，并且设置好表单字段。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81"><span class="toc-text">编写代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA%EF%BC%9A"><span class="toc-text">结果展示：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E4%BB%A3%E7%A0%81%E8%A7%A3%E9%87%8A%E4%BB%A5%E5%8F%8A%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98"><span class="toc-text">3、代码解释以及一些问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%A1%A8%E5%8D%95%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%97%E6%AE%B5%EF%BC%9A"><span class="toc-text">获取表单的所有字段：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BABaseFont%E5%AF%B9%E8%B1%A1-%E7%94%A8%E4%BA%8E%E5%8A%A0%E8%BD%BD%E5%AD%97%E4%BD%93"><span class="toc-text">创建BaseFont对象,用于加载字体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%AD%97%E6%AE%B5%E5%80%BC%E4%BB%A5%E5%8F%8A%E5%AD%97%E4%BD%93%E6%A0%B7%E5%BC%8F%E3%80%81%E5%A4%A7%E5%B0%8F%E7%AD%89%EF%BC%9A"><span class="toc-text">设置字段值以及字体样式、大小等：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%B1%95%E7%A4%BA%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%AE%9E%E7%8E%B0%EF%BC%9A"><span class="toc-text">图片展示的两种实现：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E4%BD%93%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-text">字体的问题：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E4%BD%BF%E7%94%A8Windows%E7%B3%BB%E7%BB%9F%E4%B8%8B%E7%9A%84%E5%AD%97%E4%BD%93"><span class="toc-text">1、使用Windows系统下的字体</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E4%BD%BF%E7%94%A8%E5%A4%96%E9%83%A8%E7%9A%84%E5%AD%97%E4%BD%93"><span class="toc-text">2、使用外部的字体</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E4%BD%BF%E7%94%A8iTextAsian%E7%9A%84%E5%AD%97%E4%BD%93%EF%BC%8C%E6%88%96%E8%80%85itext%E8%87%AA%E5%B8%A6%E5%AD%97%E4%BD%93%EF%BC%88%E4%B8%8D%E6%94%AF%E6%8C%81%E4%B8%AD%E6%96%87%EF%BC%89"><span class="toc-text">3、使用iTextAsian的字体，或者itext自带字体（不支持中文）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E9%A2%84%E8%A7%88%E6%97%B6%EF%BC%8C%E6%A0%87%E7%AD%BE%E9%A1%B5%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-text">浏览器预览时，标签页的问题：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E4%BD%BF%E7%94%A8itext5%E5%AE%9E%E7%8E%B0html%E8%BD%ACpdf"><span class="toc-text">4、使用itext5实现html转pdf</span></a></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/SpringBoot"><i class="tag post-item-tag">SpringBoot</i></a><a href="/tags/itext5"><i class="tag post-item-tag">itext5</i></a><a href="/tags/pdf"><i class="tag post-item-tag">pdf</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">SpringBoot接入itext5生成pdf</h1><time class="has-text-grey" datetime="2025-02-27T03:30:05.000Z">2025-02-27</time><article class="mt-2 post-content"><h1 id="SpringBoot集成itext5，实现pdf生成"><a href="#SpringBoot集成itext5，实现pdf生成" class="headerlink" title="SpringBoot集成itext5，实现pdf生成"></a>SpringBoot集成itext5，实现pdf生成</h1><h2 id="1、前言"><a href="#1、前言" class="headerlink" title="1、前言"></a>1、前言</h2><p>在项目开发中有需要生成pdf文件的功能，常见的方案如下：</p>
<ol>
<li>html作为模板，（Thymeleaf、freemaker等模板引擎）渲染数据，最后生成pdf</li>
<li>使用pdf模板（使用如：Adobe Acrobat编辑器，创建一个带有表单字段的PDF），填充数据，最后生成pdf</li>
<li>使用pdf模板（使用占位符，比如${name}），用数据替换占位符，最后生成pdf。比较复杂，不容易实现，不建议。</li>
</ol>
<p>如何得到pdf文件，主要有两种方法，一种是写代码生成，还有就是用pdf转换工具，比如wkhtmltopdf之类的。由于在项目中考虑到，使用html的方案，在修改模板时对用户不友好，所以采用了方案2：pdf模板+表单+填充数据。</p>
<p>工具使用<strong>itext5</strong>，因为itext7免费使用受到了某些限制，必须遵循 AGPL 开源协议，或购买商业许可证。还有其他免费的，如：<strong>Apache PDFBox</strong>，特点如下：</p>
<table>
<thead>
<tr>
<th align="left">技术</th>
<th align="left">特点</th>
<th align="left">适用场景</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>iText</strong></td>
<td align="left">功能强大，支持复杂 PDF 操作</td>
<td align="left">复杂 PDF 生成</td>
</tr>
<tr>
<td align="left"><strong>Apache PDFBox</strong></td>
<td align="left">免费，简单易用</td>
<td align="left">简单 PDF 生成</td>
</tr>
<tr>
<td align="left"><strong>Thymeleaf + Flying Saucer</strong></td>
<td align="left">基于 HTML 模板生成 PDF</td>
<td align="left">需要 HTML 模板的场景</td>
</tr>
<tr>
<td align="left"><strong>OpenPDF</strong></td>
<td align="left">iText 的免费分支，轻量级</td>
<td align="left">简单 PDF 生成</td>
</tr>
<tr>
<td align="left"><strong>JFreeReport + JFreeChart</strong></td>
<td align="left">支持生成带图表的 PDF</td>
<td align="left">需要图表的 PDF 生成</td>
</tr>
</tbody></table>
<h2 id="2、开发过程"><a href="#2、开发过程" class="headerlink" title="2、开发过程"></a>2、开发过程</h2><p>环境：SpringBoot 2.7.6、JDK1.8、itext 5.x</p>
<h3 id="引入相关依赖"><a href="#引入相关依赖" class="headerlink" title="引入相关依赖"></a>引入相关依赖</h3><pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
    &lt;artifactId&gt;itextpdf&lt;/artifactId&gt;
    &lt;version&gt;5.5.9&lt;/version&gt;
    &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;
&lt;!--中文字体问题解决--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
    &lt;artifactId&gt;itext-asian&lt;/artifactId&gt;
    &lt;version&gt;5.2.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="准备好pdf，并且设置好表单字段。"><a href="#准备好pdf，并且设置好表单字段。" class="headerlink" title="准备好pdf，并且设置好表单字段。"></a>准备好pdf，并且设置好表单字段。</h3><p>直接打卡Adobe Acrobat,创建一个空白pdf，然后在工具里面，点击准备表单。实际上，在创建pdf时，可以选择word文件，因为直接编辑pdf格式很难调整，而格式调整好的word转成pdf就好办多了，在相应对方添加表单域就可以了。</p>
<p><img src="/2025/02/27/SpringBoot%E6%8E%A5%E5%85%A5itext5%E7%94%9F%E6%88%90pdf/image-20250227155017718.png" alt="image-20250227155017718"></p>
<p>按钮一栏可以自行摸索，添加相应的域，这里就不多解释了。注意pic字段，我用的依然是文本域，而不是图片域，因为代码不一样，这个后面再说。</p>
<p><img src="/2025/02/27/SpringBoot%E6%8E%A5%E5%85%A5itext5%E7%94%9F%E6%88%90pdf/image-20250227162640729.png" alt="image-20250227162640729"></p>
<p>注意，复选框要设置选中显示的值，也就是图中的导出值，样式也可以设置。</p>
<h3 id="编写代码"><a href="#编写代码" class="headerlink" title="编写代码"></a>编写代码</h3><p>PdfUtils的主要方法如下：</p>
<pre><code class="java">/**
 * 通过pdf模板输出到流
 *
 * @param templateFile 模板
 * @param dataMap      input数据
 * @param picData      image图片
 * @param checkboxMap  checkbox勾选框
 * @param params       设置属性,字体大小、颜色 textfont/textcolor/textsize等
 * @param outputStream 输出流
 */
public static void output(String templateFile, Map&lt;String, Object&gt; dataMap, Map&lt;String, byte[]&gt;picData,
                          Map&lt;String, byte[]&gt; picData2,Map&lt;String, String&gt; checkboxMap, 
                          Map&lt;String,Object&gt; params,OutputStream outputStream) {
    PdfStamper ps = null;
    PdfReader reader = null;
    try {
        reader = new PdfReader(templateFile);
        ps = new PdfStamper(reader, outputStream);
        AcroFields form = ps.getAcroFields();
        BaseFont bf = BaseFont.createFont("STSongStd-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);
        form.addSubstitutionFont(bf);
        if (ObjectUtils.isNotEmpty(dataMap)) {
            for (String key : dataMap.keySet()) {
                form.setField(key, String.valueOf(dataMap.getOrDefault(key, "")));
            }
        }
        //不能编辑
        ps.setFormFlattening(true);
        if (ObjectUtils.isNotEmpty(checkboxMap)) {
            for (String key : checkboxMap.keySet()) {
                form.setField(key, checkboxMap.get(key), true);
            }
        }

        PdfStamper stamper = ps;
        if (ObjectUtils.isNotEmpty(picData)) {
            picData.forEach((filedName, imgSrc) -&gt; {
                List&lt;AcroFields.FieldPosition&gt; fieldPositions = form.getFieldPositions(filedName);
                for (AcroFields.FieldPosition fieldPosition : fieldPositions) {
                    int pageNo = fieldPosition.page;
                    Rectangle signRect = fieldPosition.position;
                    float x = signRect.getLeft();
                    float y = signRect.getBottom();
                    try {
                        Image image = Image.getInstance(imgSrc);
                        PdfContentByte under = stamper.getOverContent(pageNo);
                        image.scaleToFit(signRect.getWidth(), signRect.getHeight());
                        image.setAbsolutePosition(x, y);
                        under.addImage(image);
                    } catch (BadElementException e) {
                        log.error("pdf模板，文档元素错误 ", e);
                    } catch (IOException e) {
                        log.error("pdf模板，IO错误 ", e);
                    } catch (DocumentException e) {
                        log.error("pdf模板，文档操作错误 ", e);
                    }
                }
            });
        }
        if (!ObjectUtils.isEmpty(picData2)) {
                picData2.forEach((filedName, imgSrc) -&gt; {
                    List&lt;AcroFields.FieldPosition&gt; fieldPositions = form.getFieldPositions(filedName);
                    for (AcroFields.FieldPosition fieldPosition : fieldPositions) {
                        int pageNo = fieldPosition.page;
                        Rectangle signRect = fieldPosition.position;
                        float x = signRect.getLeft();
                        float y = signRect.getBottom();
                        try {
                            URL url = new URL(imgSrc);
                            Image image = Image.getInstance(url);
                            PdfContentByte under = stamper.getOverContent(pageNo);
                            image.scaleToFit(signRect.getWidth(), signRect.getHeight());
                            image.setAbsolutePosition(x, y);
                            under.addImage(image);
                        } catch (BadElementException e) {
                            e.printStackTrace();
                        } catch (IOException e) {
                            e.printStackTrace();
                        } catch (DocumentException e) {
                            e.printStackTrace();
                        }
                    }
                });
            }
    } catch (Exception e) {
        log.error("pdf模板填充数据异常 ", e);
    } finally {
        if (Objects.nonNull(ps)) {
            try {
                ps.close();
            } catch (Exception e) {
                log.error("pdf模板关闭异常 ", e);
            }
        }
        if (Objects.nonNull(reader)) {
            try {
                reader.close();
            } catch (Exception e) {
                log.error("pdf模板关闭异常 ", e);
            }
        }

    }
}
</code></pre>
<p>参数说明：</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>templateFile</td>
<td>String</td>
<td>/xx/xx/template.pdf</td>
<td>pdf模板,全路径</td>
</tr>
<tr>
<td>dataMap</td>
<td>Map&lt;String, Object&gt;</td>
<td>{  “name”: “John”,  “age”: 30,  “address”: “北京”}</td>
<td>文本字段数据的map</td>
</tr>
<tr>
<td>picData</td>
<td>Map&lt;String, byte[]&gt;</td>
<td>{“pic1”:”xxx”}</td>
<td>图片的数据map,其中byte[]是图片文件转成的字节数组</td>
</tr>
<tr>
<td>picData2</td>
<td>Map&lt;String, String&gt;</td>
<td>{“pic2”:”xxx”}</td>
<td>图片的数据map,其中值是图片的url地址</td>
</tr>
<tr>
<td>checkboxMap</td>
<td>Map&lt;String, String&gt;</td>
<td>{“checkbox1”:”1”}</td>
<td>复选框的数据map。1代表选中，这个是在编辑pdf模板时设置的。</td>
</tr>
<tr>
<td>params</td>
<td>Map&lt;String,Object&gt;</td>
<td>{“textsize”:”12f”}</td>
<td>设置属性,字体大小、颜色 textfont/textcolor/textsize等</td>
</tr>
<tr>
<td>outputStream</td>
<td>OutputStream</td>
<td></td>
<td>生成的pdf后，输出流</td>
</tr>
<tr>
<td>…</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>接口代码：</p>
<pre><code class="java">@GetMapping("/previewPdf")
public void previewPdf(HttpServletRequest request, HttpServletResponse response) throws IOException {
    String templateFile = "D:\\workspace\\IdeaProjects\\pdfDemo\\src\\main\\resources\\static\\template.pdf";
    Map&lt;String, Object&gt; dataMap = new HashMap&lt;&gt;();
    dataMap.put("name", "张小凡");
    dataMap.put("age", "101");
    dataMap.put("address", "上海市宛平南路600号");
    dataMap.put("year", LocalDate.now().getYear());
    dataMap.put("month", LocalDate.now().getMonthValue());
    dataMap.put("day", LocalDate.now().getDayOfMonth());

    response.setCharacterEncoding("utf-8");
    response.setContentType("application/pdf");

    Map&lt;String, byte[]&gt; picMap = new HashMap&lt;&gt;();
    byte[] imageToBytes = ImageUtil.imageToBytes("D:\\workspace\\IdeaProjects\\pdfDemo\\src\\main\\resources\\static\\33981008.jpg");
    picMap.put("pic", imageToBytes);

    Map&lt;String, String&gt; picMap2 = new HashMap&lt;&gt;();
    picMap2.put("pic2", "https://tse3-mm.cn.bing.net/th/id/OIP-C.jdP04yEoxG10mcywseQj7gAAAA?rs=1&amp;pid=ImgDetMain");

    Map&lt;String, String&gt; checkboxMap = new HashMap&lt;&gt;();
    checkboxMap.put("smoke", "1");
    checkboxMap.put("drink", "1");
    checkboxMap.put("hair", "0");

    String fileName = new String("测试预览pdf文件".getBytes(), "ISO-8859-1");//避免中文乱码
    response.setHeader("Content-Disposition", "inline;filename=".concat(String.valueOf(fileName) + ".pdf"));
    PdfUtil.output(templateFile, dataMap, picMap, picMap2,checkboxMap, response.getOutputStream());
}
</code></pre>
<p>下载的接口只要修改一行代码：</p>
<pre><code class="java">response.setHeader("Content-Disposition", "attachment;filename=".concat(fileName + ".pdf"));
</code></pre>
<h3 id="结果展示："><a href="#结果展示：" class="headerlink" title="结果展示："></a>结果展示：</h3><p><img src="/2025/02/27/SpringBoot%E6%8E%A5%E5%85%A5itext5%E7%94%9F%E6%88%90pdf/image-20250227164234458.png" alt="image-20250227164234458"></p>
<p>ok，完美</p>
<h2 id="3、代码解释以及一些问题"><a href="#3、代码解释以及一些问题" class="headerlink" title="3、代码解释以及一些问题"></a>3、代码解释以及一些问题</h2><h3 id="获取表单的所有字段："><a href="#获取表单的所有字段：" class="headerlink" title="获取表单的所有字段："></a>获取表单的所有字段：</h3><pre><code class="java">AcroFields form = ps.getAcroFields();
</code></pre>
<h3 id="创建BaseFont对象-用于加载字体"><a href="#创建BaseFont对象-用于加载字体" class="headerlink" title="创建BaseFont对象,用于加载字体"></a>创建BaseFont对象,用于加载字体</h3><pre><code class="java">BaseFont bf = BaseFont.createFont("STSongStd-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);
</code></pre>
<p>第一个参数name，是字体名称。”STSongStd-Light” 来自iTextAsian.jar，iTextAsian.jar 里面预制了各种字体,用于中日韩等文字的显示问题。”UniGB-UCS2-H”是对应的字符编码。BaseFont.NOT_EMBEDDED 字体不会嵌入到PDF文件中（没有保存），可能会导致不同电脑显示不正确。BaseFont.EMBEDDED 使用的字体会嵌入（保存）到PDF文件中，这样文件会更大一些，这样PDF文件显示就是跨平台的</p>
<p><img src="https://img-blog.csdnimg.cn/20190825093623848.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lhbWFkZWVl,size_16,color_FFFFFF,t_70" alt="aaa"></p>
<p>添加一个替代字体。这种方法用于指定一个或多个备用字体，当PDF中的字段需要显示的字符在原始字体中找不到时，iText将尝试使用这些备用字体显示字符.</p>
<pre><code class="java">form.addSubstitutionFont(bf);
</code></pre>
<h3 id="设置字段值以及字体样式、大小等："><a href="#设置字段值以及字体样式、大小等：" class="headerlink" title="设置字段值以及字体样式、大小等："></a>设置字段值以及字体样式、大小等：</h3><pre><code class="java">form.setField(key, String.valueOf(dataMap.getOrDefault(key, "")));
form.setFieldProperty(key, "textfont", bf,null);
form.setFieldProperty(key, "textsize", 15.95f,null);
//重新生成字段以应用属性更改
form.regenerateField(key);
</code></pre>
<p>注意：form.regenerateField(key)；这行代码是必须的，不然设置不会生效。</p>
<p>设置文本域不能编辑：</p>
<pre><code class="java">//不能编辑
ps.setFormFlattening(true);
</code></pre>
<h3 id="图片展示的两种实现："><a href="#图片展示的两种实现：" class="headerlink" title="图片展示的两种实现："></a>图片展示的两种实现：</h3><p>1、图片流的实现</p>
<pre><code class="java">Image image = Image.getInstance(imgSrc);
PdfContentByte under = stamper.getOverContent(pageNo);
image.scaleToFit(signRect.getWidth(), signRect.getHeight());
image.setAbsolutePosition(x, y);
under.addImage(image);
</code></pre>
<p>2、图片url的实现:</p>
<pre><code class="java">URL url = new URL(imgSrc);
Image image = Image.getInstance(url);
PdfContentByte under = stamper.getOverContent(pageNo);
image.scaleToFit(signRect.getWidth(), signRect.getHeight());
image.setAbsolutePosition(x, y);
under.addImage(image);
</code></pre>
<h3 id="字体的问题："><a href="#字体的问题：" class="headerlink" title="字体的问题："></a>字体的问题：</h3><p>如果想使用iTextAsian不包含的字体怎么办？</p>
<h4 id="1、使用Windows系统下的字体"><a href="#1、使用Windows系统下的字体" class="headerlink" title="1、使用Windows系统下的字体"></a>1、使用Windows系统下的字体</h4><p>path是字体文件的全路径。</p>
<pre><code class="java"> String path = "C:\\Windows\\Fonts\\simhei.ttf";
 BaseFont font = BaseFont.createFont(path, BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED);
</code></pre>
<p>Windows系统下的字体有的是.ttf类型，有的是.ttc类型。ttc类型的是组合字体，里面包含了几个字体的集合。若想使用ttc类型的文件，可以打开ttc文件，点击右上角下一个，看看你需要的是第几个字体，在声明字体的时候标注索引就好了。</p>
<pre><code class="java"> String path = "C:\\Windows\\Fonts\\simhei.ttf 0";
 BaseFont font = BaseFont.createFont(path, BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED);
</code></pre>
<h4 id="2、使用外部的字体"><a href="#2、使用外部的字体" class="headerlink" title="2、使用外部的字体"></a>2、使用外部的字体</h4><p>自己从网上下载字体，然后放在项目的classpath路径下：比如我的黑体文件路径：src/main/resources/fonts/simhei.ttf</p>
<pre><code class="java">BaseFont bf = BaseFont.createFont("/fonts/simhei.ttf", BaseFont.IDENTITY_H, BaseFont.EMBEDDED);
</code></pre>
<p>或者使用字体流的方式：</p>
<pre><code class="java">// 使用类加载器获取字体文件的输入流
InputStream fontStream = PdfUtil.class.getResourceAsStream("/fonts/simsun.ttf");
if (Objects.isNull(fontStream)) {
    throw new RuntimeException("找不到字体文件");
}
byte[] fontBytes = IoUtil.readBytes(fontStream);
// 使用输入流创建BaseFont对象
BaseFont bf = BaseFont.createFont("simsun.ttf", BaseFont.IDENTITY_H, BaseFont.EMBEDDED, true, fontBytes, null);
</code></pre>
<p>注意：这个时候name参数是字体的文件名称带后缀。</p>
<p>这种方式是比较推荐的，因为项目部署到不同平台，服务器自带的字体可能不支持，所以最好是放在项目中，然后嵌入pdf中。</p>
<h4 id="3、使用iTextAsian的字体，或者itext自带字体（不支持中文）"><a href="#3、使用iTextAsian的字体，或者itext自带字体（不支持中文）" class="headerlink" title="3、使用iTextAsian的字体，或者itext自带字体（不支持中文）"></a>3、使用iTextAsian的字体，或者itext自带字体（不支持中文）</h4><pre><code class="java">BaseFont bf = BaseFont.createFont("STSongStd-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);
</code></pre>
<pre><code class="java">BaseFont bf = BaseFont.createFont(BaseFont.HELVETICA, "Cp1252", BaseFont.NOT_EMBEDDED);
</code></pre>
<h3 id="浏览器预览时，标签页的问题："><a href="#浏览器预览时，标签页的问题：" class="headerlink" title="浏览器预览时，标签页的问题："></a>浏览器预览时，标签页的问题：</h3><pre><code class="java">String fileName = new String("测试预览pdf文件".getBytes(), "ISO-8859-1");//避免中文乱码
response.setHeader("Content-Disposition", "inline;filename=".concat(String.valueOf(fileName) + ".pdf"));
</code></pre>
<p>虽然代码中设置了fileName，但是标签页却无法展示。</p>
<p>原因是标签页默认展示的是文档属性里面的标题。</p>
<p><img src="/2025/02/27/SpringBoot%E6%8E%A5%E5%85%A5itext5%E7%94%9F%E6%88%90pdf/image-20250227180135113.png" alt="image-20250227180135113"></p>
<p>如果不想修改文档属性的标题，可以在代码中修改重新设置标题。</p>
<pre><code class="java">// 获取文档信息
  Map&lt;String, String&gt; info = reader.getInfo();
  if (info == null) {
      info = new HashMap&lt;&gt;();
  }
  // 修改标题，默认显示在浏览器的标签页上，如果不设置，标签页会显示原先文档属性的标题（adobe，打开文件，属性，设置标题）
  info.put("Title", "这是一个pdf");
  // 设置文档信息
  ps.setMoreInfo(info);
</code></pre>
<p>效果：</p>
<p><img src="/2025/02/27/SpringBoot%E6%8E%A5%E5%85%A5itext5%E7%94%9F%E6%88%90pdf/image-20250228142139535.png" alt="image-20250228142139535"></p>
<h2 id="4、使用itext5实现html转pdf"><a href="#4、使用itext5实现html转pdf" class="headerlink" title="4、使用itext5实现html转pdf"></a>4、使用itext5实现html转pdf</h2><p>由于pdf模板无法做到word那样根据内容大小自动换行，只能提前预估内容，设置文本域高度和宽度，特别是下划线上填充内容时，一行显示不下，不能自动换行，所以一些情况下，pdf模板填充内容无法满足需求。这时候考虑使用word模板然后转pdf，或者使用html转pdf。</p>
<p>itext5可以实现html转pdf。引入新的依赖：</p>
<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.itextpdf.tool&lt;/groupId&gt;
    &lt;artifactId&gt;xmlworker&lt;/artifactId&gt;
    &lt;version&gt;5.5.13.4&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>html可以是一个真实的文件，也可以是html字符串，还可以用模板引擎。最后都是转成流参数。简单实例：</p>
<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"/&gt;
    &lt;style&gt;
        body {
            font-family: "SimSun", "Microsoft YaHei", sans-serif;
        }
    &lt;/style&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;h1 style="text-align: center"&gt;标题&lt;/h1&gt;
&lt;p&gt;这是一段测试文本！&lt;/p&gt;
&lt;p style="text-align: left;color: red"&gt;这是第二段测试文本！&lt;/p&gt;
&lt;div&gt;
    &lt;img src="http://www.baidu.com/img/bdlogo.gif" alt="百度" title="百度" width="100" height="100"/&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="java">@GetMapping("/previewPdf7")
public void previewPdf7(HttpServletRequest request, HttpServletResponse response) throws IOException, DocumentException {
    // 创建 PDF 文档
    Document document = new Document();
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    PdfWriter writer = PdfWriter.getInstance(document, baos);
    document.open();

    // 读取 HTML 文件
   // FileInputStream htmlFile = new FileInputStream("input.html");

    String html = "&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello, World!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;";
    InputStream htmlStream = new ByteArrayInputStream(html.getBytes(StandardCharsets.UTF_8));
    // 从类路径加载 HTML 文件
    InputStream htmlFile = MyPdfController.class.getResourceAsStream("/static/index2.html");
    document.addTitle("html转pdf测试");

    FontProvider asianFontProvider = new FontProvider() {
        @Override
        public boolean isRegistered(String s) {
            return false;
        }

        @Override
        public Font getFont(String s, String s1, boolean b, float v, int i, BaseColor baseColor) {
            BaseFont bfChinese = null;
            try {
                bfChinese = BaseFont.createFont("STSongStd-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);
            } catch (DocumentException | IOException e) {
                throw new RuntimeException(e);
            }
            return new Font(bfChinese, v, i, baseColor);
        }
    };

    // 使用 XMLWorkerHelper 将 HTML 转换为 PDF
   // XMLWorkerHelper.getInstance().parseXHtml(writer, document, htmlFile, StandardCharsets.UTF_8, new AsianFontProvider());
    XMLWorkerHelper.getInstance().parseXHtml(writer, document, htmlFile, StandardCharsets.UTF_8, asianFontProvider);
    // 关闭文档
    document.close();


    // 获取 PDF 字节流
    byte[] pdfBytes = baos.toByteArray();

    response.setCharacterEncoding(StandardCharsets.UTF_8.toString());
    response.setContentType(MediaType.APPLICATION_PDF_VALUE);
    String fileName = new String("test".getBytes(), StandardCharsets.ISO_8859_1);
    response.setHeader(Header.CONTENT_DISPOSITION.getValue(), "inline;filename=".concat(fileName + ".pdf"));
    // 将 PDF 字节流写入响应输出流
    OutputStream out = response.getOutputStream();
    out.write(pdfBytes);
    out.flush();
    out.close();
}
</code></pre>
<p>注意中文的问题，需要FontProvider加载中文字体才能显示中文，否则会乱码。也可以单独写一个中文的class，然后，当成参数，传给parseXHtml方法。比如：</p>
<pre><code class="java">/**
 * 用于中文显示的Provider
 */
class AsianFontProvider extends XMLWorkerFontProvider {
    @Override
    public Font getFont(final String fontname, String encoding, float size, final int style) {
        try {
            BaseFont bfChinese = BaseFont.createFont("STSongStd-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);
            return new Font(bfChinese, size, style);
        } catch (Exception e) {
        }
        return super.getFont(fontname, encoding, size, style);
    }
}
</code></pre>
<p>字体可以是iTextAsian中的，也可以自定义加载字体，这个和前面的一样。效果如下：</p>
<p><img src="/2025/02/27/SpringBoot%E6%8E%A5%E5%85%A5itext5%E7%94%9F%E6%88%90pdf/image-20250318160427999.png" alt="image-20250318160427999"></p>
<p>到这里还没结束，简单的html和简单样式可以，但是稍微复杂的样式，itext5就不支持了，所以样式多的html用itext5效果很不好。比如这样一个html页面转成pdf后，效果很差。</p>
<p><img src="/2025/02/27/SpringBoot%E6%8E%A5%E5%85%A5itext5%E7%94%9F%E6%88%90pdf/image-20250318161132356.png" alt="image-20250318161132356"></p>
<p>pdf：</p>
<p><img src="/2025/02/27/SpringBoot%E6%8E%A5%E5%85%A5itext5%E7%94%9F%E6%88%90pdf/image-20250318161321981.png" alt="image-20250318161321981"></p>
<p>最重要的是表格显示不全，也许调整html样式可以解决，但是太麻烦，itext5对css样式支持有限是主要问题。text7支持更多的css样式，但是有开源协议的限制。</p>
<p>继续尝试其他的转pdf工具，比如：</p>
<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.xhtmlrenderer&lt;/groupId&gt;
    &lt;artifactId&gt;flying-saucer-pdf-itext5&lt;/artifactId&gt;
    &lt;version&gt;9.1.22&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>但是效果一样不好，而且需要在html中指定字体，不然中文显示不出来。</p>
<pre><code class="html">&lt;style&gt;
    body {
        font-family: "SimSun", "Microsoft YaHei", sans-serif;
    }
&lt;/style&gt;
</code></pre>
<p><img src="/2025/02/27/SpringBoot%E6%8E%A5%E5%85%A5itext5%E7%94%9F%E6%88%90pdf/image-20250318162158739.png" alt="image-20250318162158739"></p>
<p>最后使用wkhtmltox工具，经过测试，这个工具转pdf效果好，所以采用这个方案，缺点是需要在服务器上安装工具、还有字体。</p>
<p>用工具转pdf后，可以直接保存到服务器上，也可以返回文件流。</p>
<pre><code class="java">@GetMapping("/previewPdf8")
public void previewPdf8(HttpServletResponse response) {
    response.setCharacterEncoding(StandardCharsets.UTF_8.toString());
    response.setContentType(MediaType.APPLICATION_PDF_VALUE);

    // HTML 内容
    String htmlContent = "&lt;!DOCTYPE html&gt;\n" +
            "&lt;html&gt;\n" +
            "&lt;head&gt;\n" +
            "    &lt;meta charset=\"UTF-8\"/&gt;\n" +
            "&lt;/head&gt;\n" +
            "&lt;body&gt; &lt;div data-v-137a61c0=\"\" style=\"text-align: center; font-size: 20px; font-weight: bold; margin-bottom: 30px;\"&gt; xxx患者病历单 &lt;/div&gt;&lt;table data-v-137a61c0=\"\" cellspacing=\"0\" style=\"width: 100%; border-collapse: collapse;\"&gt;&lt;tr data-v-137a61c0=\"\" style=\"border: 1px solid rgb(102, 102, 102); min-height: 40px;\"&gt;&lt;td data-v-137a61c0=\"\" colspan=\"6\" style=\"background: lightblue; line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 200px;\"&gt;患者基本信息&lt;/td&gt;&lt;/tr&gt;&lt;tr data-v-137a61c0=\"\" style=\"border: 1px solid rgb(102, 102, 102); min-height: 40px;\"&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 100px;\"&gt;姓名&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 200px;\"&gt;test012&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 100px;\"&gt;性别&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 200px;\"&gt;男&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 100px;\"&gt;证件号&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 200px;\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr data-v-137a61c0=\"\" style=\"border: 1px solid rgb(102, 102, 102); min-height: 40px;\"&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 100px;\"&gt;年龄&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 200px;\"&gt;&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 100px;\"&gt;婚姻&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 200px;\"&gt; &lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 100px;\"&gt;身高&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 200px;\"&gt; &lt;/td&gt;&lt;/tr&gt;&lt;tr data-v-137a61c0=\"\" style=\"border: 1px solid rgb(102, 102, 102); min-height: 40px;\"&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 100px;\"&gt;体重&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 200px;\"&gt; &lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 100px;\"&gt;民族&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 200px;\"&gt;&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 100px;\"&gt;就诊ID&lt;/td&gt;&lt;td data-v-137a61c0=\"\" style=\"line-height: 30px; padding: 5px 10px; border-spacing: 0px; border-right: 1px solid rgb(102, 102, 102); font-size: 14px; width: 200px;\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;div data-v-137a61c0=\"\" style=\"font-size: 12px; color: rgb(102, 102, 102); margin: 20px 0px;\"&gt; 注：远程诊疗是异地医疗咨询活动，门诊医师与申请门诊医师之间的关系属于医学知识的咨询关系，对病人的诊断与治疗的决定权属于收治病人的医疗机构（引自原卫生部卫办发[1999]第2号）。 &lt;/div&gt;" +
            "&lt;/body&gt;\n" +
            "&lt;/html&gt;";
    // 调用 wkhtmltopdf 将 HTML 字符串转换为 PDF 字节流
    try {
        byte[] pdfBytes = htmlToPdf(htmlContent);
        System.out.println("PDF 生成成功！大小: " + pdfBytes.length + " 字节");

        //避免中文乱码
        String fileName = new String("test".getBytes(), StandardCharsets.ISO_8859_1);
        response.setHeader("Content-Disposition", "inline;filename=".concat(fileName) + ".pdf");
        OutputStream outputStream = response.getOutputStream();
        outputStream.write(pdfBytes);
        outputStream.flush();
        outputStream.close();
    } catch (IOException | InterruptedException e) {
        e.printStackTrace();
    }
}


public  byte[] htmlToPdf(String htmlContent) throws IOException, InterruptedException {
    // 创建 ProcessBuilder
    ProcessBuilder processBuilder = new ProcessBuilder("wkhtmltopdf", "-", "-");
    processBuilder.redirectErrorStream(true);

    // 启动进程
    Process process = processBuilder.start();

    // 将 HTML 内容写入进程的标准输入
    try (OutputStream stdin = process.getOutputStream();
         BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(stdin))) {
        writer.write(htmlContent);
    }

    // 捕获进程的标准输出（PDF 字节流）
    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
    try (InputStream stdout = process.getInputStream()) {
        byte[] buffer = new byte[1024];
        int length;
        while ((length = stdout.read(buffer)) != -1) {
            outputStream.write(buffer, 0, length);
        }
    }

    // 等待进程完成
    int exitCode = process.waitFor();
    if (exitCode != 0) {
        throw new IOException("wkhtmltopdf 进程执行失败，退出码: " + exitCode);
    }

    // 返回 PDF 字节流
    return outputStream.toByteArray();
}
</code></pre>
<p>效果如下：</p>
<p><img src="/2025/02/27/SpringBoot%E6%8E%A5%E5%85%A5itext5%E7%94%9F%E6%88%90pdf/image-20250318162816661.png" alt="image-20250318162816661"></p>
<p>工具的效果还是比较好的。</p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2025/03/27/python%E5%AD%A6%E4%B9%A0/" title="python学习"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: python学习</span></a><a class="button is-default" href="/2025/01/23/Vue2%E5%AD%A6%E4%B9%A0/" title="Vue2学习"><span class="has-text-weight-semibold">Next: Vue2学习</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="zhangqingguo/zhangqingguo.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com//"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/zhangqingguo"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com//"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> ZQG 2025</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"> </script></body></html>